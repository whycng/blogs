å¤ªå¥½äº† âœ…ï¼Œä¸‹é¢æ˜¯ä½ è¦çš„**ä¸€é”®å¼ GitHub ä»“åº“å¤‡ä»½è„šæœ¬**ï¼Œæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š

---

## âœ… è„šæœ¬åŠŸèƒ½ä¸€è§ˆï¼š

* è¾“å…¥ï¼šä¸€ä¸ª `repos.txt`ï¼Œåˆ—å‡ºä½ è¦å¤‡ä»½çš„å¤šä¸ªä»“åº“ï¼ˆæ ¼å¼ï¼š`owner/repo`ï¼‰
* è‡ªåŠ¨æ‰§è¡Œï¼š

  * `git clone` ä»£ç 
  * ä½¿ç”¨ `github-backup` å¤‡ä»½ï¼š

    * issues
    * issue è¯„è®º
    * pull requestsï¼ˆå«è¯„è®º / æäº¤ / è¯¦æƒ…ï¼‰
    * wiki
    * releases
    * assets
* è¾“å‡ºï¼šå…¨éƒ¨ä¿å­˜åˆ° `./backup/<repo>/` ç›®å½•ä¸­

---

## ğŸ“‚ ç›®å½•ç»“æ„å»ºè®®ï¼š

```
your-backup-folder/
â”œâ”€â”€ .env                 # æ”¾ GitHub token
â”œâ”€â”€ repos.txt            # ä»“åº“åˆ—è¡¨ï¼Œä¸€è¡Œä¸€ä¸ª owner/repo
â””â”€â”€ github_backup.sh     # è„šæœ¬æœ¬ä½“
```

---

## ğŸ“„ 1. `.env` ç¤ºä¾‹ï¼š

```dotenv
GITHUB_TOKEN=ghp_xxxxxxxxä½ çš„token
```

---

## ğŸ“„ 2. `repos.txt` ç¤ºä¾‹ï¼š

```
knemik97/manifesto-against-the-plagiarist-yunhe-wang
bytedance/trae-agent
```

---

## âš™ï¸ 3. `github_backup.sh` è„šæœ¬ï¼š

```bash
#!/bin/bash

# è¯»å– .env ä¸­çš„ token
if [ -f .env ]; then
  export $(grep -v '^#' .env | xargs)
fi

if [ -z "$GITHUB_TOKEN" ]; then
  echo "âŒ è¯·åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½® GITHUB_TOKEN"
  exit 1
fi

# æ£€æŸ¥ github-backup æ˜¯å¦å®‰è£…
GITHUB_BACKUP_CMD=$(which github-backup)
if [ -z "$GITHUB_BACKUP_CMD" ]; then
  echo "âŒ æœªæ‰¾åˆ° github-backup å‘½ä»¤ï¼Œè¯·å…ˆæ¿€æ´» venv æˆ–å®‰è£…"
  exit 1
fi

mkdir -p backup

# éå† repos.txt åˆ—è¡¨
while IFS= read -r repo; do
  if [[ "$repo" =~ ^#.*$ || -z "$repo" ]]; then
    continue  # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
  fi

  echo "ğŸ” å¤„ç†ä»“åº“ï¼š$repo"

  owner=$(echo "$repo" | cut -d'/' -f1)
  repo_name=$(echo "$repo" | cut -d'/' -f2)
  repo_dir="./backup/$repo_name"

  mkdir -p "$repo_dir"

  # å…‹éš†ä»“åº“ä»£ç 
  if [ ! -d "$repo_dir/source-code/.git" ]; then
    echo "â¬‡ï¸  cloning $repo ..."
    git clone "https://github.com/$repo.git" "$repo_dir/source-code"
  else
    echo "âœ…  å·²å­˜åœ¨æºç ç›®å½•ï¼Œè·³è¿‡ clone"
  fi

  # ä½¿ç”¨ github-backup ä¸‹è½½ issuesã€PRã€wiki ç­‰
  echo "ğŸ§±  å¤‡ä»½å…ƒæ•°æ®åˆ° $repo_dir ..."
  github-backup "$owner" \
    --token "$GITHUB_TOKEN" \
    --repository "$repo_name" \
    --output-directory "$repo_dir" \
    --issues --issue-comments \
    --pulls --pull-comments --pull-commits --pull-details \
    --wikis --releases --assets \
    --skip-archived --skip-existing

  echo "âœ… å®Œæˆå¤‡ä»½ï¼š$repo"
  echo "-----------------------------"

done < repos.txt
```

---

## âœ… ä½¿ç”¨æ–¹æ³•ï¼ˆæ€»ç»“ï¼‰ï¼š

```bash
cd your-backup-folder
chmod +x github_backup.sh

# æ‰§è¡Œ
./github_backup.sh
```

---

## ğŸ“¦ å¤‡ä»½è¾“å‡ºç¤ºä¾‹ï¼š

```
backup/
â”œâ”€â”€ manifesto-against-the-plagiarist-yunhe-wang/
â”‚   â”œâ”€â”€ source-code/           â† git clone çš„æºç 
â”‚   â”œâ”€â”€ issues/                â† æ‰€æœ‰ issuesï¼ˆjsonï¼‰
â”‚   â”œâ”€â”€ pulls/                 â† æ‰€æœ‰ PR è¯¦æƒ…
â”‚   â”œâ”€â”€ releases/              â† å‘å¸ƒç‰ˆä¿¡æ¯
â”‚   â””â”€â”€ ...                    â† å…¶ä»–å…ƒæ•°æ®
â”œâ”€â”€ trae-agent/
â”‚   â”œâ”€â”€ source-code/
â”‚   â”œâ”€â”€ ...
```

---

æ˜¯å¦ä¹Ÿéœ€è¦æˆ‘ç»™ä½ åšæˆ `.tar.gz` å‹ç¼©åŒ…å‘½ä»¤ï¼Ÿæˆ–è€…æ”¯æŒå¢é‡å¤‡ä»½ã€æŒ‰æ—¥æœŸå½’æ¡£ï¼Ÿæˆ‘å¯ä»¥å¸®ä½ ç»§ç»­æ‰©å±•è¿™ä¸ªè„šæœ¬ã€‚




å¾ˆæ£’çš„æƒ³æ³•ï¼å¢é‡å¤‡ä»½ + æ—¥æœŸå½’æ¡£èƒ½å¸®ä½ æ›´å®‰å…¨åœ°ä¿ç•™å†å²çŠ¶æ€ï¼Œè¿˜èƒ½èŠ‚çœæ—¶é—´å’Œå­˜å‚¨ã€‚

---

## âœ… æˆ‘æ¥æ•™ä½ å¦‚ä½•ç»™ç°æœ‰è„šæœ¬åŠ ä¸Šï¼š

---

# ğŸ§  åŠŸèƒ½ 1ï¼š**å¢é‡å¤‡ä»½**

### âœ¨ åŸç†ï¼š

* `github-backup` è‡ªå¸¦é€‰é¡¹ï¼š`--skip-existing` å’Œ `--incremental-by-files`
* å®ƒåœ¨å¤‡ä»½ç›®å½•ä¸­æ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œé¿å…é‡å¤ä¸‹è½½

âœ… ä½  **å·²ç»ç”¨äº†** `--skip-existing`ï¼Œå†åŠ ä¸Šï¼š

```bash
--incremental-by-files
```

å¯ä»¥è®©å®ƒæ›´æ™ºèƒ½åœ°åªå¤‡ä»½æ–°å†…å®¹ã€‚

---

## ğŸ“… åŠŸèƒ½ 2ï¼š**æŒ‰æ—¥æœŸå½’æ¡£**

### âœ¨ æ–¹æ¡ˆï¼š

å°†æ¯æ¬¡çš„å¤‡ä»½ç›®å½•å†™å…¥å¸¦æ—¥æœŸçš„å­ç›®å½•ï¼Œä¾‹å¦‚ï¼š

```
backup/trae-agent/2025-07-08/
backup/manifesto-against.../2025-07-08/
```

è¿™æ ·ä½ å°±èƒ½ï¼š

* ä¿ç•™æ¯æ¬¡å¤‡ä»½çš„å¿«ç…§
* æ—¥å diff æˆ–æ¢å¤å¾ˆæ–¹ä¾¿

---

## ğŸ”§ è„šæœ¬å‡çº§ï¼ˆå¢é‡ + æ—¥æœŸï¼‰

æ›¿æ¢ä½ åŸæ¥çš„ `github_backup.sh` å†…å®¹å¦‚ä¸‹ ğŸ‘‡ï¼š

```bash
#!/bin/bash

# è¯»å– .env ä¸­çš„ token
if [ -f .env ]; then
  export $(grep -v '^#' .env | xargs)
fi

if [ -z "$GITHUB_TOKEN" ]; then
  echo "âŒ è¯·åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½® GITHUB_TOKEN"
  exit 1
fi

# è·å–å½“å‰æ—¥æœŸ
today=$(date +"%Y-%m-%d")

# æ£€æŸ¥ github-backup æ˜¯å¦å®‰è£…
GITHUB_BACKUP_CMD=$(which github-backup)
if [ -z "$GITHUB_BACKUP_CMD" ]; then
  echo "âŒ æœªæ‰¾åˆ° github-backup å‘½ä»¤ï¼Œè¯·å…ˆæ¿€æ´» venv æˆ–å®‰è£…"
  exit 1
fi

mkdir -p backup

# éå† repos.txt åˆ—è¡¨
while IFS= read -r repo; do
  if [[ "$repo" =~ ^#.*$ || -z "$repo" ]]; then
    continue  # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
  fi

  echo "ğŸ” å¤„ç†ä»“åº“ï¼š$repo"

  owner=$(echo "$repo" | cut -d'/' -f1)
  repo_name=$(echo "$repo" | cut -d'/' -f2)
  base_dir="./backup/$repo_name"
  date_dir="$base_dir/$today"

  mkdir -p "$date_dir"

  # å…‹éš†æºç ï¼ˆä»…ç¬¬ä¸€æ¬¡ clone åˆ° base_dir/source-codeï¼‰
  if [ ! -d "$base_dir/source-code/.git" ]; then
    echo "â¬‡ï¸ cloning æºç ï¼š$repo"
    git clone "https://github.com/$repo.git" "$base_dir/source-code"
  else
    echo "ğŸ”„ æ‹‰å–æœ€æ–°æºç ï¼š$repo"
    cd "$base_dir/source-code" && git pull && cd - > /dev/null
  fi

  # å¤‡ä»½ metadata
  echo "ğŸ“¦ å¤‡ä»½å…ƒæ•°æ®åˆ°ï¼š$date_dir"
  github-backup "$owner" \
    --token "$GITHUB_TOKEN" \
    --repository "$repo_name" \
    --output-directory "$date_dir" \
    --issues --issue-comments \
    --pulls --pull-comments --pull-commits --pull-details \
    --wikis --releases --assets \
    --incremental-by-files --skip-archived --skip-existing

  echo "âœ… å®Œæˆå¤‡ä»½ï¼š$repo âœ $today"
  echo "-----------------------------"

done < repos.txt
```

---

## âœ… æ‰§è¡Œæ•ˆæœ

æ¯æ¬¡æ‰§è¡Œåï¼Œä½ çš„ç›®å½•ç»“æ„å°†å˜æˆï¼š

```
backup/
â””â”€â”€ trae-agent/
    â”œâ”€â”€ source-code/         â† æŒä¹…çš„æºç ä»“åº“ï¼ˆæ‹‰å–æœ€æ–°ï¼‰
    â””â”€â”€ 2025-07-08/          â† æœ¬æ¬¡å¤‡ä»½å¿«ç…§
        â”œâ”€â”€ issues/
        â”œâ”€â”€ pulls/
        â”œâ”€â”€ ...
```

---

## ğŸ” è‡ªåŠ¨å®šæ—¶ï¼ˆå¯é€‰ï¼‰

ä½ å¯ä»¥åŠ ä¸€ä¸ª `cron` å®šæ—¶ä»»åŠ¡ï¼Œæ¯å¤©å‡Œæ™¨è‡ªåŠ¨è¿è¡Œï¼š

```bash
0 2 * * * /path/to/github_backup.sh >> /path/to/backup.log 2>&1
```

---

## â˜ï¸ è¦ä¸è¦åŠ ä¸Šâ€œæ‰“åŒ…å½’æ¡£â€ï¼ˆè‡ªåŠ¨ zip æ¯æ—¥ç›®å½•ï¼‰ï¼Ÿ

ä¾‹ï¼š

```bash
zip -r backup/$repo_name/$today.zip backup/$repo_name/$today
```

ä½ å¯ä»¥èŠ‚çœç©ºé—´ï¼Œä¹Ÿæ–¹ä¾¿åŒæ­¥åˆ°ç½‘ç›˜æˆ–å½’æ¡£åº“ã€‚

æ˜¯å¦éœ€è¦æˆ‘ä¸€å¹¶åŠ è¿›è„šæœ¬ï¼Ÿ


å¥½å˜ âœ…ï¼æˆ‘ç°åœ¨å¸®ä½ æŠŠ **å¢é‡å¤‡ä»½ + æ—¥æœŸå½’æ¡£ + è‡ªåŠ¨æ‰“åŒ…å‹ç¼©** å…¨éƒ¨æ•´åˆè¿›ä¸€ä¸ªæœ€ç»ˆè„šæœ¬ã€‚ä½ åªéœ€è¦å‡†å¤‡ï¼š

* `.env`ï¼ˆGitHub Tokenï¼‰
* `repos.txt`ï¼ˆè¦å¤‡ä»½çš„ä»“åº“åˆ—è¡¨ï¼‰
* è¿è¡Œè„šæœ¬å³å¯ï¼Œå•¥éƒ½æå®šï¼

---

## ğŸ§  åŠŸèƒ½ä¸€è§ˆï¼š

| åŠŸèƒ½                    | å®ç°æƒ…å†µ             |
| --------------------- | ---------------- |
| âœ… æ”¯æŒå¤šä»“åº“å¤‡ä»½             | âœ”ï¸               |
| âœ… è‡ªåŠ¨æ‹‰å–/æ›´æ–°æºç            | âœ”ï¸               |
| âœ… å¢é‡å¤‡ä»½ issues/PR/wiki | âœ”ï¸ï¼ˆè·³è¿‡å·²å­˜åœ¨ï¼‰        |
| âœ… æ¯æ—¥å¿«ç…§å½’æ¡£              | âœ”ï¸ï¼ˆ`YYYY-MM-DD`ï¼‰ |
| âœ… è‡ªåŠ¨ `.zip` å‹ç¼©        | âœ”ï¸               |

---

## ğŸ“œ æœ€ç»ˆè„šæœ¬ `github_backup.sh`ï¼ˆå®Œæ•´ç‰ˆï¼‰ï¼š

```bash
#!/bin/bash

# === é…ç½®åŠ è½½ ===
if [ -f .env ]; then
  export $(grep -v '^#' .env | xargs)
fi

if [ -z "$GITHUB_TOKEN" ]; then
  echo "âŒ è¯·åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½® GITHUB_TOKEN"
  exit 1
fi

GITHUB_BACKUP_CMD=$(which github-backup)
if [ -z "$GITHUB_BACKUP_CMD" ]; then
  echo "âŒ æœªæ‰¾åˆ° github-backup å‘½ä»¤ï¼Œè¯·å…ˆæ¿€æ´» venv æˆ–å®‰è£…"
  exit 1
fi

# å½“å‰æ—¥æœŸ
today=$(date +"%Y-%m-%d")
mkdir -p backup

# === å¼€å§‹éå†ä»“åº“åˆ—è¡¨ ===
while IFS= read -r repo; do
  if [[ "$repo" =~ ^#.*$ || -z "$repo" ]]; then
    continue  # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
  fi

  echo "ğŸ” æ­£åœ¨å¤„ç†ä»“åº“ï¼š$repo"

  owner=$(echo "$repo" | cut -d'/' -f1)
  repo_name=$(echo "$repo" | cut -d'/' -f2)
  base_dir="./backup/$repo_name"
  date_dir="$base_dir/$today"
  zip_file="$base_dir/${today}.zip"

  mkdir -p "$date_dir"

  # === å…‹éš†æˆ–æ›´æ–°æºç  ===
  if [ ! -d "$base_dir/source-code/.git" ]; then
    echo "â¬‡ï¸ cloning æºç ï¼š$repo"
    git clone "https://github.com/$repo.git" "$base_dir/source-code"
  else
    echo "ğŸ”„ æ›´æ–°æºç ï¼š$repo"
    cd "$base_dir/source-code" && git pull && cd - > /dev/null
  fi

  # === ä½¿ç”¨ github-backup å¤‡ä»½å…ƒæ•°æ® ===
  echo "ğŸ“¦ å¤‡ä»½å…ƒæ•°æ®åˆ°ï¼š$date_dir"
  github-backup "$owner" \
    --token "$GITHUB_TOKEN" \
    --repository "$repo_name" \
    --output-directory "$date_dir" \
    --issues --issue-comments \
    --pulls --pull-comments --pull-commits --pull-details \
    --wikis --releases --assets \
    --incremental-by-files --skip-archived --skip-existing

  # === æ‰“åŒ…å½’æ¡£ ===
  echo "ğŸ“¦ æ‰“åŒ… $date_dir âœ $zip_file"
  zip -r -q "$zip_file" "$date_dir"

  echo "âœ… å®Œæˆï¼š$repo âœ $today"
  echo "-----------------------------------"

done < repos.txt
```

---

## ğŸ§ª ç”¨æ³•æ€»ç»“ï¼š

1. åˆ›å»ºç›®å½•ç»“æ„ï¼š

```
your-backup-folder/
â”œâ”€â”€ .env
â”œâ”€â”€ repos.txt
â””â”€â”€ github_backup.sh
```

2. è®¾ç½®æƒé™å¹¶è¿è¡Œï¼š

```bash
chmod +x github_backup.sh
./github_backup.sh
```

---

## ğŸ“‚ è¾“å‡ºç»“æ„ç¤ºä¾‹ï¼š

```
backup/
â””â”€â”€ trae-agent/
    â”œâ”€â”€ source-code/                 â† æºç 
    â”œâ”€â”€ 2025-07-08/                  â† å½“å¤© metadata
    â”‚   â”œâ”€â”€ issues/
    â”‚   â”œâ”€â”€ pulls/
    â”‚   â””â”€â”€ ...
    â””â”€â”€ 2025-07-08.zip               â† æ‰“åŒ…å½’æ¡£
```

---

## ğŸ§© å¯é€‰æ‰©å±•ï¼ˆéšæ—¶åŠ ï¼‰ï¼š

* è‡ªåŠ¨æ¨é€åˆ°è¿œç¨‹å¤‡ä»½ Git ä»“åº“ï¼Ÿ
* åŒæ­¥ `.zip` åˆ° OneDrive / Dropboxï¼Ÿ
* å¤‡ä»½ star é¡¹ç›®æˆ–ç»„ç»‡ä¸‹æ‰€æœ‰é¡¹ç›®ï¼Ÿ
* å¯¹ issues æ‰§è¡Œç­›é€‰æˆ–è½¬ markdown å¯¼å‡ºï¼Ÿ

ä½ åªè¦è¯´æƒ³è¦ï¼Œæˆ‘å°±èƒ½å®‰æ’ ğŸ˜



ä½ å¤ªç»™åŠ›äº†ğŸ˜ï¼ç°åœ¨å°±æ¥å¸®ä½ å®ç° **å‰ä¸¤é¡¹æ‰©å±•åŠŸèƒ½**ï¼š

---

## ğŸš€ ç›®æ ‡

### âœ… 1. è‡ªåŠ¨æŠŠ `.zip` å¤‡ä»½æ¨é€åˆ°è¿œç¨‹ Git ä»“åº“ï¼ˆæ¯”å¦‚ GitHub æˆ–ç§æœ‰ Giteaï¼‰

### âœ… 2. åŒæ­¥ `.zip` åˆ°æœ¬åœ°æŒ‚è½½çš„ OneDrive / Dropboxï¼ˆæˆ–ä»»æ„ç›®å½•ï¼‰

---

## ğŸ§© å‡è®¾å‰æ

ä½ å·²ç»æœ‰ï¼š

1. **è¿œç¨‹ Git ä»“åº“**ï¼ˆæ¯”å¦‚ä½ åˆ›å»ºäº†ä¸€ä¸ª `github-backup-archive` ç§æœ‰ä»“åº“ï¼‰
2. OneDrive/Dropbox å·²æŒ‚è½½åœ¨ç³»ç»Ÿç›®å½•ï¼Œå¦‚ï¼š

   ```bash
   ~/OneDrive/Backups/github-daily
   ```

---

## ğŸ”§ 1. æ‰©å±•æ¨é€ `.zip` åˆ°è¿œç¨‹ Git ä»“åº“

æˆ‘ä»¬æŠŠæ‰€æœ‰ `.zip` å¤åˆ¶åˆ°ä¸€ä¸ªä¸“é—¨çš„ä»“åº“ç›®å½•é‡Œï¼ˆä¾‹å¦‚ `backup-zips/`ï¼‰ï¼Œç„¶å commit + pushã€‚

### ğŸ—‚ ç›®å½•ç»“æ„ï¼ˆæ–°å¢ï¼‰ï¼š

```
backup/
â””â”€â”€ zips/                            â† è¿™é‡Œå­˜æ‰€æœ‰ .zip å¿«ç…§æ–‡ä»¶
    â”œâ”€â”€ trae-agent_2025-07-08.zip
    â”œâ”€â”€ ...
    â””â”€â”€ .git/                        â† Git ä»“åº“ï¼Œç”¨æ¥ version æ§åˆ¶ zip æ–‡ä»¶
```

---

### âœ… è„šæœ¬ä¸­æ–°å¢éƒ¨åˆ†ï¼š

åœ¨ä¸»è„šæœ¬æœ«å°¾æ·»åŠ ï¼š

```bash
# === æ”¶é›† .zip æ–‡ä»¶å¹¶æ¨é€åˆ° backup-zips ä»“åº“ ===

ZIP_REPO="./backup/zips"
mkdir -p "$ZIP_REPO"

zip_target_name="${repo_name}_${today}.zip"
cp "$zip_file" "$ZIP_REPO/$zip_target_name"

cd "$ZIP_REPO"

# åˆå§‹åŒ– git ä»“åº“ï¼ˆç¬¬ä¸€æ¬¡ï¼‰
if [ ! -d ".git" ]; then
    git init
    git remote add origin git@github.com:ä½ çš„ç”¨æˆ·å/github-backup-archive.git
fi

git add "$zip_target_name"
git commit -m "Backup for $repo_name on $today"
git push origin master

cd - > /dev/null
```

ğŸ“Œ æ³¨ï¼š

* è¯·å°† `git@github.com:ä½ çš„ç”¨æˆ·å/github-backup-archive.git` æ›¿æ¢æˆä½ çš„å®é™…è¿œç¨‹ä»“åº“åœ°å€
* å¦‚æœä½¿ç”¨ HTTPSï¼Œè®°å¾—å¤„ç†å¥½è®¤è¯ï¼ˆtoken æˆ– credential helperï¼‰

---

## â˜ï¸ 2. åŒæ­¥ `.zip` åˆ° OneDrive / Dropbox

åªéœ€æŠŠæ‰“åŒ…å¥½çš„ zip å¤åˆ¶è¿‡å»å³å¯ã€‚

### å‡è®¾ä½ æŒ‚è½½è·¯å¾„æ˜¯ï¼š

```bash
~/OneDrive/Backups/github-daily/
```

### âœ… è„šæœ¬ä¸­æ·»åŠ ï¼š

```bash
# === åŒæ­¥å¤‡ä»½åˆ° OneDrive/Dropbox ===
onedrive_target=~/OneDrive/Backups/github-daily
mkdir -p "$onedrive_target"

cp "$zip_file" "$onedrive_target/$repo_name-$today.zip"
echo "â˜ï¸  å·²å¤åˆ¶å¤‡ä»½ zip åˆ° OneDrive: $onedrive_target/$repo_name-$today.zip"
```

---

## âœ… å…¨æµç¨‹æ€»ç»“å›¾

```
æ¯æ—¥æ‰§è¡Œ ./github_backup.sh
        |
        |-- å…‹éš†æºç  (source-code/)
        |-- å¤‡ä»½ metadata (issues, PRs...)
        |-- å‹ç¼©ä¸º YYYY-MM-DD.zip
        |       |
        |       â”œâ”€â”€ å¤åˆ¶ zip åˆ° OneDrive
        |       â””â”€â”€ å¤åˆ¶ zip åˆ° backup/zips â†’ Git commit & push
```

---

## ğŸš€ BONUSï¼ˆä¸€æ¬¡æ€§åˆå§‹åŒ–è¿œç¨‹ zip ä»“åº“ï¼‰

å¦‚æœä½ è¦ç¬¬ä¸€æ¬¡åˆå§‹åŒ–è¿œç¨‹ä»“åº“ï¼ˆæ¯”å¦‚ `github-backup-archive`ï¼‰ï¼Œæ‰§è¡Œï¼š

```bash
cd ./backup
mkdir zips
cd zips
git init
git remote add origin git@github.com:ä½ ç”¨æˆ·å/github-backup-archive.git
touch .gitkeep
git add .gitkeep
git commit -m "init zip archive"
git push origin master
```

---

## è¦ä¸è¦æˆ‘ç°åœ¨å¸®ä½ åˆå¹¶è¿›æœ€ç»ˆè„šæœ¬ï¼Œè´´ä¸€ä»½å®Œæ•´çš„ï¼Ÿä¸€é”®å…¨åŠŸèƒ½ï¼Ÿ


å¤ªå¥½äº† ğŸ’ªï¼Œç°åœ¨æˆ‘å°±ä¸ºä½ å¥‰ä¸Šæœ€ç»ˆç‰ˆæœ¬çš„è¶…çº§ GitHub å¤‡ä»½è„šæœ¬ï¼ŒåŒ…å«ä½ è¦çš„å…¨éƒ¨åŠŸèƒ½ï¼š

---

## âœ… åŠŸèƒ½æ€»è§ˆï¼š

| åŠŸèƒ½                        | è¯´æ˜                                    |
| ------------------------- | ------------------------------------- |
| âœ”ï¸ å¤šä»“åº“æ”¯æŒ                  | ä» `repos.txt` è¯»å–å¤šä¸ª `owner/repo`       |
| âœ”ï¸ æºç å¤‡ä»½                   | è‡ªåŠ¨ `clone` æˆ– `pull` æ›´æ–°                |
| âœ”ï¸ å…ƒæ•°æ®å¤‡ä»½ï¼ˆissuesã€PR ç­‰ï¼‰     | ä½¿ç”¨ `github-backup` å¢é‡å¤‡ä»½               |
| âœ”ï¸ æ—¥æœŸå½’æ¡£                   | æ¯æ¬¡å¤‡ä»½æŒ‰ `YYYY-MM-DD/` å­˜å‚¨                |
| âœ”ï¸ è‡ªåŠ¨ `.zip` æ‰“åŒ…           | å¤‡ä»½å®Œæ¯•åç”Ÿæˆå‹ç¼©åŒ…                            |
| âœ”ï¸ æ¨é€ `.zip` åˆ°è¿œç¨‹ Git ä»“åº“   | å¦‚ `github-backup-archive`             |
| âœ”ï¸ åŒæ­¥ `.zip` åˆ° OneDrive ç­‰ | æ‹·è´ `.zip` åˆ°ä»»æ„æŒ‚è½½è·¯å¾„ï¼ˆå¦‚ OneDrive/Dropboxï¼‰ |

---

## ğŸ“œ è„šæœ¬æ–‡ä»¶ï¼š`github_backup.sh`

```bash
#!/bin/bash

# === åŠ è½½ GitHub token ===
if [ -f .env ]; then
  export $(grep -v '^#' .env | xargs)
fi

if [ -z "$GITHUB_TOKEN" ]; then
  echo "âŒ è¯·åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½® GITHUB_TOKEN"
  exit 1
fi

# æ£€æŸ¥ä¾èµ–
GITHUB_BACKUP_CMD=$(which github-backup)
if [ -z "$GITHUB_BACKUP_CMD" ]; then
  echo "âŒ æœªæ‰¾åˆ° github-backupï¼Œè¯·æ¿€æ´» venv æˆ–å®‰è£…"
  exit 1
fi

# å½“å‰æ—¥æœŸ
today=$(date +"%Y-%m-%d")

# é…ç½®è·¯å¾„
BASE_BACKUP_DIR="./backup"
ZIP_REPO="$BASE_BACKUP_DIR/zips"
ONEDRIVE_PATH=~/OneDrive/Backups/github-daily   # â† å¯è‡ªå®šä¹‰ç›®æ ‡è·¯å¾„
mkdir -p "$BASE_BACKUP_DIR" "$ZIP_REPO" "$ONEDRIVE_PATH"

# === ä¸»æµç¨‹ ===
while IFS= read -r repo; do
  if [[ "$repo" =~ ^#.*$ || -z "$repo" ]]; then
    continue
  fi

  echo "ğŸ” å¼€å§‹å¤„ç†ï¼š$repo"

  owner=$(echo "$repo" | cut -d'/' -f1)
  repo_name=$(echo "$repo" | cut -d'/' -f2)
  repo_dir="$BASE_BACKUP_DIR/$repo_name"
  date_dir="$repo_dir/$today"
  zip_file="$repo_dir/${today}.zip"
  zip_target_name="${repo_name}_${today}.zip"

  mkdir -p "$date_dir"

  # === å…‹éš†/æ›´æ–°æºç  ===
  if [ ! -d "$repo_dir/source-code/.git" ]; then
    echo "â¬‡ï¸ cloning æºç ï¼š$repo"
    git clone "https://github.com/$repo.git" "$repo_dir/source-code"
  else
    echo "ğŸ”„ æ›´æ–°æºç ï¼š$repo"
    cd "$repo_dir/source-code" && git pull && cd - > /dev/null
  fi

  # === å…ƒæ•°æ®å¤‡ä»½ ===
  echo "ğŸ“¦ å¤‡ä»½å…ƒæ•°æ®åˆ°ï¼š$date_dir"
  github-backup "$owner" \
    --token "$GITHUB_TOKEN" \
    --repository "$repo_name" \
    --output-directory "$date_dir" \
    --issues --issue-comments \
    --pulls --pull-comments --pull-commits --pull-details \
    --wikis --releases --assets \
    --incremental-by-files --skip-archived --skip-existing

  # === æ‰“åŒ… .zip ===
  echo "ğŸ“¦ æ‰“åŒ…ä¸º zipï¼š$zip_file"
  zip -r -q "$zip_file" "$date_dir"

  # === æ¨é€ zip åˆ° Git å½’æ¡£ä»“åº“ ===
  cp "$zip_file" "$ZIP_REPO/$zip_target_name"
  cd "$ZIP_REPO"
  if [ ! -d ".git" ]; then
    git init
    git remote add origin git@github.com:ä½ çš„ç”¨æˆ·å/github-backup-archive.git  # ä¿®æ”¹æ­¤å¤„
  fi
  git add "$zip_target_name"
  git commit -m "Backup $repo_name on $today"
  git push origin master
  cd - > /dev/null

  # === åŒæ­¥ zip åˆ° OneDrive/Dropbox ç›®å½• ===
  cp "$zip_file" "$ONEDRIVE_PATH/$zip_target_name"
  echo "â˜ï¸  å·²å¤åˆ¶ zip åˆ° OneDriveï¼š$ONEDRIVE_PATH/$zip_target_name"

  echo "âœ… å®Œæˆï¼š$repo"
  echo "-----------------------------------"

done < repos.txt
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„ï¼š

ä½ æœ€ç»ˆä¼šæœ‰ï¼š

```
backup/
â”œâ”€â”€ trae-agent/
â”‚   â”œâ”€â”€ source-code/
â”‚   â”œâ”€â”€ 2025-07-08/
â”‚   â””â”€â”€ 2025-07-08.zip
â”œâ”€â”€ zips/
â”‚   â”œâ”€â”€ trae-agent_2025-07-08.zip  â† ä¼šè¢« push åˆ°è¿œç¨‹ Git å½’æ¡£
â””â”€â”€ ...
```

---

## ğŸ§ª ä½¿ç”¨æ–¹æ³•ï¼š

1. ç¼–è¾‘ `.env`ï¼š

```dotenv
GITHUB_TOKEN=ghp_xxxxä½ çš„token
```

2. ç¼–è¾‘ `repos.txt`ï¼ˆä¸€è¡Œä¸€ä¸ªä»“åº“ï¼‰ï¼š

```
bytedance/trae-agent
knemik97/manifesto-against-the-plagiarist-yunhe-wang
```

3. åˆå§‹åŒ– zip Git ä»“åº“ï¼ˆåªåšä¸€æ¬¡ï¼‰ï¼š

```bash
cd backup/zips
git init
git remote add origin git@github.com:ä½ çš„ç”¨æˆ·å/github-backup-archive.git
touch .gitkeep
git add .gitkeep && git commit -m "init"
git push origin master
```

4. è¿è¡Œä¸»è„šæœ¬ï¼š

```bash
chmod +x github_backup.sh
./github_backup.sh
```

---

## â˜‘ï¸ ä¸‹ä¸€æ­¥æ¨èï¼š

* [ ] æŠŠè¿™ä¸ªè„šæœ¬åŠ åˆ° cron å®ç°æ¯æ—¥å®šæ—¶å¤‡ä»½ï¼š

  ```bash
  0 3 * * * /path/to/github_backup.sh >> /path/to/backup.log 2>&1
  ```

* [ ] å¤šäººåä½œæ—¶ï¼Œå°† `.zip` Git å½’æ¡£ä»“åº“è®¾ä¸ºç§æœ‰

---

éœ€è¦æˆ‘å†ç»™ä½ åšä¸ªä¸€é”®å®‰è£…è„šæœ¬ï¼ˆè¿ venvã€pipxã€github-backup éƒ½è£…å¥½ï¼‰ä¹Ÿå¯ä»¥ ğŸ˜ è¦ä¸è¦é¡ºä¾¿ï¼Ÿ

